# Docker Compose
도커 파일에 이어 도커 컴포즈에 대해서 학습을 진행하겠습니다.

## What is Docer Compose
`Docker Compose`는 멀티 컨테이너 애플리케이션을 정의하고 실행하기 위한 도구 입니다.

`Copomse`는 전체 애플리케이션 스택의 제어를 간소화하여 서비스, 네트워크 및 볼륨을 이해하기 쉬운 단일 `YAML` 구성 파일에서 쉽게 관리할 수 있도록 합니다. 그런 다음 단일 명령으로 구성 파일에서 모든 서비스를 만들고 시작합니다.

주요 명령어
```cmd
# 도커 서비스 시작
$ docker compose up

# 실행 중인 서비스를 중지하고 제거
$ docker compose down

# 모든 서비스를 현재 상태와 함께 나열
$ docker compose ps
```

## 도커 컴포즈를 사용하는 이유
여러 개의 컨테이너가 하나의 어플리케이션으로 동작할 때 `도커 컴포즈`를 사용하지 않는다면, 이를 테스트하려면 각 컨테이너를 하나씩 생성해야 합니다. 예를 들면, 웹 어플리케이션을 테스트하려면 웹 서버 컨테이너, 데이터베이스 컨테이너를 각각 생성해야 합니다.

`도커 컴포즈`는 여러 개의 컨테이너 옵션과 환경을 정의한 파일을 읽어 컨테이너를 순차적으로 생성하는 방식으로 동작합니다. 각 컨테이너의 의존성, 네트워크, 볼륨 등을 함께 YAML 파일에 정의할 수 있습니다.

태그 정리

- `services` : 생성될 컨테이너들을 묶어놓은 단위입니다. 서비스 항목 아래에는 각 컨테이너에 적용될 생성 옵션을 지정합니다.
- `image` : 서비스의 컨테이너를 생성할 때 쓰일 이미지의 이름을 설정합니다.
- `links` : 다른 서비스에 서비스명만으로 접근할 수 있도록 설정합니다.
- `environment` : docker run --env, -e 옵션과 동일합니다. 서비스의 컨테이너 내부에서 사용할 환경변수를 지정하며, 딕셔너리나 배열 형태로 사용할 수 있습니다.

등등 다양한 옵션들이 있는데, 그때그때 찾아보도록 하자.

## `Docker-compose` VS `Docker`
|  항목   |`docker` |`docker-compose`|
|---------|---------|----------------|
|실행 방법|명령어로 직접 실행 (`docker run ...`)| `docker-compose.yml` 파일을 이용해 실행(`docker-compose up`)|
|컨테이너 개수| 한 번에 하나의 컨테이너 실행| 여러 개의 컨테이너를 한 번에 실행 가능|
|유지 관리| 설정을 일일이 입력해야 함 | 설정 파일을 작성하여 자동 실행 가능|
|재사용성|컨테이너를 삭제하면 설정도 삭제됨|`docker-compose.yml`파일을 수정하여 유지 가능|

### 참조
[도커 컴포즈](https://docs.docker.com/compose/)
[블로그 정리 - docker compose 개념 정리](https://seosh817.tistory.com/387#%EB%8F%84%EC%BB%A4%20%EC%BB%B4%ED%8F%AC%EC%A6%88%EB%A5%BC%20%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%20%EC%9D%B4%EC%9C%A0-1)